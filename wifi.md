# WiFi

WiFi 使用无需授权的 ISM 波段；对于任何人在任何地方来说，部署 WiFi 都是十分简单的，它需要的硬件是十分简易的。不足为奇的是，WiFi 成为了实际上部署最广，最为流行的无线标准之一。

拥有 WiFi 商标的国际 WiFi 联盟是一个致力于建立并推广无线局域网技术的商业联盟，提供互操作性标准和测试。技术上来讲，一个设备必须经过国际 WiFi 联盟的认证才能使用 WiFi 的图标和名称，但是实际上，这个名称被用来指代任何基于 802.11 标准的设备。

 1997 年提出了第一个 802.11 协议的草案，或多或少的直接吸收了以太网标准（IEEE 802.3）进入到无线交流的世界。然而，直到在 1999 年引入了 802.11b 标准，WiFi 设备的市场才开始发展。相对简化的技术，简单的部署，便捷，在无需授权的 2.4 GHz ISM 波段使得任何人都可以方便的利用已有的局域网提供“无线扩展”。如今，大多数的新式笔记本，台式电脑，平板电脑，智能手机，等等几乎所有设备都可以使用 WiFi。

 # 从以太网到无线局域网
 802.11 无线标准最初被设计为以太网(802.3)标准的扩展。以太网通常用来指代局域网标准，802.11 系列（图 6-1）相应的被用做无线局域网标准（WLAN）。然而从技术上来讲，很多以太网协议由 ALOHA 网络协议启发，这是第一个公开展示的无线网络，由夏威夷大学在 1971 年开发。换句话说，我们转了个圈子。

 ![](assets/2017-05-14-16-27-37.png)

 图 6-1 802.3 (以太网) 与 802.11 (WiFi)，数据和物理层

了解调度所有通信的机制需要我们弄清楚 ALOHA 网络以及接下来的以太网与 WiFI 协议之间的区别。换句话说，它们都需要共享介质作为“随机接触信道”，无论是有线还是无线电波，这意味着没有主进程或者调度器来控制在某一时刻谁或者哪个设备可以发送数据。相反，每一个设备自己决定是否发送数据，所有的设备在一起工作来保证共享信道的性能表现。

以太网标准历史上使用了概率载波侦听多路访问（CSMA）协议，通俗来说是在发送之前先听一下。如果你有数据要发送了：
1. 检测是否有人在传输数据
2. 如果信道繁忙，一直监听直到信道空闲
3. 当信道空闲的时候，立即发送数据

当然，任何信号的传输都需要时间，因此冲突仍然会发生。为了这个原因，以太网标准添加了冲突检测（CSMA/CD），当冲突发生的时候，双方立即停止传输数据并随机休眠一段时间（带有指数回退）。这样，多个相互竞争的发送者就不会同步发送或者同时重新发送数据。

WiFi 使用了一个类似但有一点不同的模型：由于硬件对无线电的限制，无法在发送数据的时候检测冲突。因此，WiFi 使用了冲突避免机制（CSMA/CA），每一个发送者都只在信道是空闲的时候发送整个信息帧来尝试避免冲突。一旦 WiFi 帧发出，在下一次发送数据前要等待接收方显示的应答。

有一些更多的细节,但简而言之是说: 这些技术的组合保证以太网和 WiFi 都可以正常的接触共享介质。在以太网中，媒介是物理连接，在无线的情况下，共享的是无线电信道。

实践中，在网络负载很低的情况下，随机访问模型工作的很好。我们不会在这里展示太多的数学，但是我们可以证明为了达到一个很好的信道使用率（最小化冲突数量），信道负载需要低于 10%。如果负载保持的很低，我们可以在没有显示的协调或调度的情况下达到很高的吞吐。然而，如果负载增加，冲突的数量会急剧上升，这会导致整个网络的性能不稳定。

**note**
如果你尝试过高负载的 WiFi 网络，有许多发送方在竞争访问网络，在一个大型公共场所中，例如一个会议室，你会直接感受到不稳定的 WiFi 性能表现。当然，概率调度模型不是唯一的因素，但是是一个重要的印象因素。

# WiFi 标准与特点
WiFi 802.11b 标准已经进入日常生活之中，但是和其他流行的标准一样， IEEE 802 标准委员会并没有闲下来，仍旧在不断的推出新的标准（表 6-1），它们有着更高的吞吐，更好的调制技术，多路传输和很多其他的新特性。

802.11 协议|推出时间|频率(GHz)|带宽（MHz）|每个流数据速率（Mbit/s）|最大 MIMO 流数量
----|----|----|----|-----|-----
b|1999 年 9 月|2.4|20|1, 2, 5.5, 11|1
g|2003 年 6 月|2.4|20|6, 9, 12, 18, 24, 36, 48, 54|1
n|2009 年 10 月|2.4|20|7.2, 14.4, 21.7, 28.9, 43.3, 57.8, 65, 72.2|4
n|2009 年 9 月|5   |40|15, 30, 45, 60, 90, 120, 135, 150|4
ac|2014 年    |5  |20,40,80,160|大约 866.7 |8

今天，“b” 和 “g”  标准是部署和支持最广泛的标准。都使用了无需授权的 2.4 GHz 的 ISM 波段，最多支持一个无线数据流。取决于当地法规，传输功率可能被限制到最大 200 mW。一些路由器可以调整这个值，但是很可能无法超过当地运行的最大值。

所以我们如何提升我们 WiFI 网络的性能呢？“n” 和 “ac” 标准将每个信道的带宽增加了一倍，从 20 MHz 到了 40 MHz，使用了高阶调制算法并且增加了并行多路无线电传输流-多输入和多输出（MIMO）。所有的特性结合起来，即将来临的 “ac” 无线标准在理想状况下可以达到吉比特以上的吞吐。

